<project name="PhotoTopo" default="all" basedir=".">

	<property file="project.properties"/>
	<property name="PREFIX" value="." />
	<property description="Folder for output and min target" name="dist" value="${PREFIX}/dist" />

	<property name="OUT" value="${dist}/phototopo-${version}.js" />
	<property name="OUT_MIN" value="${dist}/phototopo-${version}-min.js" />

	<target name="all" depends="build,min" />

	<target name="build" depends="" description="Main build, concatenates source files and replaces @VERSION">
		<echo message="Building ${OUT}" />
		<mkdir dir="${dist}" />
		<concat destfile="${OUT}">
			<fileset file="phototopo.js" />
		</concat>
		<replaceregexp match="@VERSION" replace="${version}" flags="g" byline="true" file="${OUT}" />
		<echo message="Project built." />
	</target>

	<target name="lint" depends="build" description="Check jQuery against JSLint">
		<exec executable="java">
			<arg line="-jar build/js.jar build/jslint-check.js" />
		</exec>
	</target>

	<target name="min" depends="build" description="Remove all comments and whitespace, no compression, great in combination with GZip">
		<echo message="Building ${OUT_MIN}" />
		<java fork="true" jar="build/yuicompressor-2.4.2.jar">
			<arg line="--type=js" />
			<arg line="${OUT}" />
			<arg line="-o" />
			<arg line="${OUT_MIN}" />
		</java>
		<echo message="${OUT_MIN} built." />
	</target>

	<target name="clean">
		<delete dir="${dist}" />
	</target>


</project>
